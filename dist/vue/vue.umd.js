(function(h,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(h=typeof globalThis<"u"?globalThis:h||self,e(h.UEditorPlusDesignerVue={},h.Vue))})(this,function(h,e){"use strict";var $t=Object.defineProperty;var Nt=(h,e,V)=>e in h?$t(h,e,{enumerable:!0,configurable:!0,writable:!0,value:V}):h[e]=V;var C=(h,e,V)=>Nt(h,typeof e!="symbol"?e+"":e,V);const V="https://paiban.tecmz.com/api/live_rich_editor";async function le(){var n;try{const o=await fetch(`${V}/categories`,{method:"POST",headers:{"Content-Type":"application/json"},body:"{}"});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const t=await o.json();if(t.code!==0||!((n=t.data)!=null&&n.tree))throw new Error(t.msg||"Failed to fetch categories");return J(t.data.tree)}catch(o){return console.error("Failed to fetch categories:",o),[]}}function J(n){return n.map(o=>({id:o.id,title:o.title,pid:o.pid,sort:o.sort||0,_child:o._child?J(o._child):void 0}))}async function re(n){try{const o={paginate:{page:(n==null?void 0:n.page)||1,pageSize:(n==null?void 0:n.pageSize)||100,search:{}}};n!=null&&n.categoryId&&(o.paginate.search.categoryId=n.categoryId),n!=null&&n.keywords&&(o.paginate.search.keywords=n.keywords);const t=await fetch(`${V}/paginate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const i=await t.json();if(i.code!==0||!i.data)throw new Error(i.msg||"Failed to fetch materials");return i.data}catch(o){return console.error("Failed to fetch materials:",o),{page:1,pageSize:(n==null?void 0:n.pageSize)||10,total:0,records:[]}}}function ae(n){return n.map(o=>({...o,id:o.id,title:o.title,html:o.html}))}async function ce(){try{return await le()}catch(n){return console.error("Default category loader error:",n),[]}}async function de(n){try{const o=await re(n);return{records:ae(o.records),total:o.total,page:o.page,pageSize:o.pageSize}}catch(o){return console.error("Default style loader error:",o),{records:[],total:0,page:1,pageSize:(n==null?void 0:n.pageSize)||100}}}const g={SectionClass:"pb-section",SectionActiveClass:"pb-section-active",SectionHoverClass:"pb-section-hover",DefaultCategoryLoader:ce,DefaultStyleLoader:de},me=[["source","|","undo","redo","|","bold","italic","underline","fontborder","strikethrough","superscript","subscript","removeformat","formatmatch","autotypeset","blockquote","pasteplain","|","forecolor","backcolor","insertorderedlist","insertunorderedlist","selectall","cleardoc","|","rowspacingtop","rowspacingbottom","lineheight","|","customstyle","paragraph","fontfamily","fontsize","|","directionalityltr","directionalityrtl","indent","|","justifyleft","justifycenter","justifyright","justifyjustify","|","touppercase","tolowercase","|","link","unlink","anchor","|","imagenone","imageleft","imageright","imagecenter","|","insertimage","emotion","scrawl","insertvideo","attachment","map","insertframe","insertcode","pagebreak","template","background","|","horizontal","date","time","spechars","wordimage","|","inserttable","deletetable","insertparagraphbeforetable","insertrow","deleterow","insertcol","deletecol","mergecells","mergeright","mergedown","splittocells","splittorows","splittocols","|","print","preview","searchreplace","shortcutmenu"]];let T=!1,Z=!1;const A=[];function ue(n="/ueditor-plus"){return new Promise((o,t)=>{if(Z&&window.UE){o(window.UE);return}if(T){A.push(()=>o(window.UE));return}T=!0;const i=n.endsWith("/")?n:`${n}/`;window.UEDITOR_HOME_URL=i;const s=document.createElement("script");s.src=`${i}ueditor.config.js`,s.onload=()=>{const a=document.createElement("script");a.src=`${i}ueditor.all.js`,a.onload=()=>{Z=!0,T=!1,A.forEach(y=>y()),A.length=0,o(window.UE)},a.onerror=()=>{T=!1,t(new Error("Failed to load UEditor main script"))},document.head.appendChild(a)},s.onerror=()=>{T=!1,t(new Error("Failed to load UEditor config script"))},document.head.appendChild(s)})}const fe=`
/* Section基础样式 */
section.pb-section {
  position: relative;
  margin: 10px auto;
  padding: 0;
  transition: all 0.2s;
  cursor: pointer;
  min-height: 20px;
}

/* Section激活状态 */
section.pb-section.pb-section-active {
  outline: 2px dashed rgba(255, 0, 0, 0.4);
  outline-offset: 2px;
}

/* 子Section悬停状态 */
section.pb-section .pb-section-hover {
  outline: 1px dashed rgba(0, 0, 255, 0.3);
  outline-offset: 1px;
}

/* 子Section激活状态 */
section.pb-section .pb-section-active {
  outline: 1px dashed rgba(0, 0, 255, 0.5);
  outline-offset: 1px;
}

/* 子Section样式 */
section:not(.pb-section) {
  position: relative;
  transition: all 0.2s;
}

section:not(.pb-section).pb-section-hover {
  outline: 1px dashed rgba(0, 0, 255, 0.3);
  outline-offset: 1px;
}

/* 图片样式增强 */
section.pb-section img {
  max-width: 100%;
  height: auto;
  display: block;
  transition: all 0.2s;
}

section.pb-section img:hover {
  opacity: 0.9;
  cursor: pointer;
}

/* 表格样式优化 */
section.pb-section table {
  border-collapse: collapse;
  width: 100%;
  margin: 10px 0;
}

section.pb-section table td,
section.pb-section table th {
  border: 1px solid #ddd;
  padding: 8px;
}

section.pb-section table th {
  background: #f5f5f5;
  font-weight: bold;
}

/* 防止内容溢出 */
section.pb-section {
  overflow: hidden;
  word-wrap: break-word;
}

/* 空Section提示 */
section.pb-section:empty::before {
  content: '空内容块 - 点击编辑';
  color: #999;
  font-size: 14px;
}
`;class he{constructor(o){C(this,"config");C(this,"container",null);C(this,"editor",null);C(this,"editorId");C(this,"eventHandlers",new Map);C(this,"resizeHandler",null);C(this,"editorElement",null);const t=o.ueditorConfig||{};t.iframeCssStylesAddition||(t.iframeCssStylesAddition=[]),t.iframeCssStylesAddition=[fe,...t.iframeCssStylesAddition],t.toolbars||(t.toolbars=me),t.toolbars[t.toolbars.length-1].push("liveeditor");let i=o.categoryLoader||g.DefaultCategoryLoader,s=o.styleLoader||g.DefaultStyleLoader;this.config={container:o.container||"#editor",ueditorPath:o.ueditorPath||"/ueditor-plus",ueditorConfig:t,categoryLoader:i,styleLoader:s,onReady:o.onReady||(()=>{}),onChange:o.onChange||(()=>{})},this.editorId=`ueditorPlusDesigner_${Date.now()}`}async init(){if(typeof this.config.container=="string"?this.container=document.querySelector(this.config.container):this.container=this.config.container,!this.container)throw new Error("Container not found");await ue(this.config.ueditorPath);const o=window.UE;if(!o)throw new Error("UEditor failed to load");const t=document.createElement("div");t.id=this.editorId,this.container.appendChild(t),this.editorElement=t;const i={autoHeightEnabled:!1,initialFrameWidth:"100%",...this.config.ueditorConfig};this.editor=o.getEditor(this.editorId,i),this.editorEvent(),Math.random()>.5&&(new window.Image().src="https://open.modstart.com/license-logo.png?ueditor-plus-designer"),this.editor.ready(()=>{this.setupResizeListener(),this.doLayout(),this.config.onReady(),this.emit("ready")}),this.editor.addListener("contentChange",()=>{const s=this.getContent();this.config.onChange(s),this.emit("change",s)})}editorEvent(){this.editor.on("click",(o,t)=>{const i=t.target,s=i.closest(`.${g.SectionClass}`);if(!s||(this.editor.document.querySelectorAll(`.${g.SectionClass}`).forEach(d=>{d.classList.remove(g.SectionActiveClass)}),s.classList.add(g.SectionActiveClass),this.editor.selection.getText()))return;let r=null;const l=this.editor.selection.getRange().getClosedNode();l&&l.tagName&&l.tagName.toLowerCase()==="img"&&(r=l),this.emit("section-click",{section:s,element:i,image:r})}),this.editor.addListener("mouseover mouseout",(o,t)=>{const i=t.target;if(this.editor.document.querySelectorAll(`section:not(.${g.SectionClass})`).forEach(a=>{a.classList.remove(g.SectionHoverClass)}),!i.classList.contains(g.SectionClass)){const a=i.closest(`section:not(.${g.SectionClass})`);o==="mouseover"&&a&&a.classList.add(g.SectionHoverClass)}})}getContent(){var o;return((o=this.editor)==null?void 0:o.getContent())||""}setContent(o){var t;(t=this.editor)==null||t.setContent(o)}insertSection(o,t){if(!this.editor)return;const i=(t==null?void 0:t.id)||"",s=`<section class="${g.SectionClass} ${g.SectionActiveClass}" data-section-id="${i}">${o}</section>`;this.editor.execCommand("insertHtml",s)}doLayout(){if(!this.container||!this.editor||!this.editorElement)return;const o=this.container.clientHeight,t=this.editorElement.querySelector(".edui-editor-toolbarbox"),i=t?t.offsetHeight:0,s=o-i;this.editor.setHeight(Math.max(s,100))}setupResizeListener(){let o=null;this.resizeHandler=()=>{o!==null&&window.clearTimeout(o),o=window.setTimeout(()=>{this.doLayout()},150)},window.addEventListener("resize",this.resizeHandler)}destroy(){var o;this.resizeHandler&&(window.removeEventListener("resize",this.resizeHandler),this.resizeHandler=null),(o=this.editor)==null||o.destroy(),this.editor=null,this.eventHandlers.clear()}on(o,t){this.eventHandlers.has(o)||this.eventHandlers.set(o,[]),this.eventHandlers.get(o).push(t)}off(o,t){if(!t){this.eventHandlers.delete(o);return}const i=this.eventHandlers.get(o);if(i){const s=i.indexOf(t);s>-1&&i.splice(s,1)}}emit(o,...t){const i=this.eventHandlers.get(o);i&&i.forEach(s=>s(...t))}getEditor(){return this.editor}}function G(n){const o=e.ref([]),t=e.ref([]),i=e.ref(0),s=e.ref(!1),a=e.ref(!1),y=e.ref(!1),r=e.ref(0),l=e.ref(""),d=e.ref(1),c=e.ref(100),f=e.ref(!0),N=()=>n.categoryLoader?n.categoryLoader:g.DefaultCategoryLoader,L=()=>n.styleLoader?n.styleLoader:g.DefaultStyleLoader,M=async()=>{const b=N();if(b){y.value=!0;try{o.value=await b()}catch(p){console.error("Failed to load categories:",p),o.value=[]}finally{y.value=!1}}},D=async(b,p=!1)=>{const H=L();if(H){p?a.value=!0:s.value=!0;try{const _=await H({categoryId:r.value,keywords:l.value,page:d.value,pageSize:c.value,...b});p?t.value=[...t.value,..._.records]:t.value=_.records,i.value=_.total,c.value=_.pageSize;const q=Math.ceil(_.total/c.value);f.value=d.value<q}catch(_){console.error("Failed to load materials:",_),p||(t.value=[],i.value=0,f.value=!1)}finally{p?a.value=!1:s.value=!1}}},F=async()=>{a.value||!f.value||(d.value++,await D(void 0,!0))},P=b=>{r.value=b,d.value=1,f.value=!0,D()},j=b=>{l.value=b,d.value=1,f.value=!0,D()};return e.onMounted(async()=>{await M(),await D()}),{categories:o,materials:t,total:i,loading:s,loadingMore:a,loadingCategories:y,currentCategory:r,keywords:l,currentPage:d,hasMore:f,loadMaterials:D,loadMore:F,changeCategory:P,search:j}}const B=class B{constructor(){C(this,"element",null);C(this,"styles",{})}dom(o){return this.element=o,this.parse(),this}parse(){if(this.styles={},!this.element)return this;const o=this.element.getAttribute("style");if(o){const t=o.split(";");for(const i of t){if(!i.trim())continue;const[s,a]=i.split(":").map(y=>y.trim());s&&a&&(this.styles[s]=a)}}return this}remove(o){return o in this.styles&&delete this.styles[o],this}removeDomAttr(o){var t;return(t=this.element)==null||t.removeAttribute(o),this}getStyleKeys(o){const t=[];for(const i of B.prefixes){const s=`${i}${o}`;if(s in this.styles){t.push(s);break}}return t.length?t:[o]}setStyleValues(o,t){const i=this.getStyleKeys(o);if(!i.length)this.styles[o]=t("");else for(const s of i){const a=this.styles[s]||"";this.styles[s]=t(a)}}merge(o,t){if(o==="rotatez"){const i=`rotatez(${t}deg)`;this.setStyleValues("transform",s=>/rotatez\(.*?\)/.test(s)?s.replace(/rotatez\(.*?\)/,i):s?`${s} ${i}`:i)}else{this.styles[o]=String(t);for(const i of B.prefixes){const s=`${i}${o}`;s in this.styles&&(this.styles[s]=String(t))}}return this}get(o,t=null){if(!this.element)return t;switch(o){case"opacity":{let i=this.element.style.opacity;if(!i)for(const s of B.prefixes){const a=`${s}${o}`;if(a in this.styles){i=this.styles[a];break}}return i?parseFloat(i):t}case"rotatez":{const i=this.element.style.transform||"";let s=0;if(i.toLowerCase().indexOf("rotatez(")>=0){const a=i.toLowerCase().replace(/rotatex\s*\(\s*[0-9\-]*\s*deg\s*\)/g,"").replace(/rotatey\s*\(\s*[0-9\-]*\s*deg\s*\)/g,"").match(/rotatez\s*\(\s*([0-9\-]+)\s*deg\s*\)/);a&&(s=parseInt(a[1]),s>180?s-=360:s<-180&&(s+=360))}return s}default:return this.styles[o]||t}}toDom(){if(!this.element)return this;const o=[];for(const t in this.styles)o.push(`${t}:${this.styles[t]}`);return o.length?this.element.setAttribute("style",o.join(";")):this.element.removeAttribute("style"),this}};C(B,"prefixes",["-moz-","-o-","-webkit-","-ms-"]);let R=B;const $={fromDom(n){return new R().dom(n)}};function Q(){const n=e.ref(null),o=e.ref(null),t=e.ref({id:"",width:100,rotate:0,opacity:1}),i=e.ref({show:!1,element:null,width:100,opacity:1}),s=r=>{n.value=r,t.value.id=r.getAttribute("data-section-id")||"";const l=$.fromDom(r),d=r.style.width||"100%";t.value.width=parseInt(d)||100,t.value.rotate=l.get("rotatez",0),t.value.opacity=l.get("opacity",1)},a=(r,l)=>{i.value.element=l,i.value.show=!0,n.value=r;const d=$.fromDom(l),c=l.style.width||"100%";i.value.width=parseInt(c)||100,i.value.opacity=d.get("opacity",1)},y=()=>{n.value=null,o.value=null,i.value.show=!1,i.value.element=null};return e.watch(()=>t.value.width,r=>{n.value&&$.fromDom(n.value).merge("margin","0 auto").merge("width",`${r}%`).toDom().remove("max-width").removeDomAttr("width")}),e.watch(()=>t.value.rotate,r=>{n.value&&$.fromDom(n.value).merge("rotatez",r).toDom()}),e.watch(()=>t.value.opacity,r=>{n.value&&$.fromDom(n.value).merge("opacity",r).toDom()}),e.watch(()=>i.value.width,r=>{i.value.element&&$.fromDom(i.value.element).remove("max-width").merge("width",`${r}%`).toDom().removeDomAttr("width")}),e.watch(()=>i.value.opacity,r=>{i.value.element&&$.fromDom(i.value.element).merge("opacity",r).toDom()}),{currentSection:n,currentElement:o,sectionData:t,imageData:i,prepareSectionStyle:s,prepareImageStyle:a,clearSelection:y}}function pe(){const n=(r,l)=>{r&&(r.undoManger.save(),l(),r.undoManger.save(),r.syncCommandState())};return{clearSectionFormat:(r,l)=>{!r||!l||n(r,()=>{r.selection.getRange().selectNode(l).select(),r.execCommand("removeformat"),l.className=`${g.SectionClass} ${g.SectionActiveClass}`})},insertSection:(r,l,d)=>{if(!r||!l)return;const c=document.createElement("section");c.className=g.SectionClass,c.setAttribute("data-section-id","");const f=document.createElement("p"),N=document.createElement("br");f.appendChild(N),c.appendChild(f),n(r,()=>{var L,M;d==="before"?(L=l.parentNode)==null||L.insertBefore(c,l):(M=l.parentNode)==null||M.insertBefore(c,l.nextSibling)}),r.selection.getRange().setStart(f,0).setCursor(!1,!0)},selectSection:(r,l)=>{!r||!l||n(r,()=>{r.selection.getRange().selectNode(l).select()})},deleteSection:(r,l)=>{!r||!l||n(r,()=>{l.remove()})},moveSectionUp:(r,l)=>{if(!r||!l)return;const d=l.previousElementSibling;d&&n(r,()=>{var c;(c=l.parentNode)==null||c.insertBefore(l,d)})},moveSectionDown:(r,l)=>{if(!r||!l)return;const d=l.nextElementSibling;d&&n(r,()=>{var c;(c=l.parentNode)==null||c.insertBefore(l,d.nextSibling)})}}}const ge={class:"upd-material-panel"},ye={class:"upd-material-body"},we={class:"upd-material-item"},Ee={class:"upd-material-item__head"},Se={class:"upd-category"},Ce={class:"upd-category__item"},be=["onClick"],_e={key:0,class:"upd-category__children"},ke=["onClick"],ve={class:"upd-filter"},Ve={class:"upd-filter__search"},$e={class:"upd-material-item__body"},Ne={key:0,class:"upd-loading"},De={key:1,class:"upd-material-list"},xe=["onClick"],Be=["innerHTML"],Le={class:"upd-material-list__info"},Me={class:"upd-material-list__title"},ze={class:"upd-material-list__id"},Te={key:0,class:"upd-loading-more"},Ie={key:1,class:"upd-no-more"},He=e.defineComponent({__name:"MaterialPanel",props:{categories:{},materials:{},total:{},currentCategory:{},loading:{type:Boolean,default:!1},loadingMore:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!0}},emits:["select","change-category","search","load-more"],setup(n,{emit:o}){const t=n,i=o,s=e.ref(""),a=e.ref(null),y=()=>{i("search",s.value)},r=()=>{if(!a.value||t.loading||t.loadingMore||!t.hasMore)return;const l=a.value,d=l.scrollTop,c=l.scrollHeight,f=l.clientHeight;d+f>=c-50&&i("load-more")};return e.onMounted(()=>{a.value=document.querySelector(".upd-material-item"),a.value&&a.value.addEventListener("scroll",r)}),e.onUnmounted(()=>{a.value&&a.value.removeEventListener("scroll",r)}),(l,d)=>(e.openBlock(),e.createElementBlock("div",ge,[e.createElementVNode("div",ye,[e.createElementVNode("div",we,[e.createElementVNode("div",Ee,[e.createElementVNode("div",Se,[e.createElementVNode("div",Ce,[e.createElementVNode("div",{class:e.normalizeClass(["upd-category__title",{"upd-category__title--active":n.currentCategory===0}]),onClick:d[0]||(d[0]=c=>l.$emit("change-category",0))}," 全部 ",2)]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.categories,c=>(e.openBlock(),e.createElementBlock("div",{key:c.id,class:"upd-category__item"},[e.createElementVNode("div",{class:e.normalizeClass(["upd-category__title",{"upd-category__title--active":c.id===n.currentCategory||c._child&&c._child.some(f=>f.id===n.currentCategory)}]),onClick:f=>l.$emit("change-category",c.id)},e.toDisplayString(c.title),11,be),c._child&&c._child.length?(e.openBlock(),e.createElementBlock("div",_e,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c._child,f=>(e.openBlock(),e.createElementBlock("div",{key:f.id,class:e.normalizeClass(["upd-category__child-title",{"upd-category__child-title--active":f.id===n.currentCategory}]),onClick:e.withModifiers(N=>l.$emit("change-category",f.id),["stop"])},e.toDisplayString(f.title),11,ke))),128))])):e.createCommentVNode("",!0)]))),128))]),e.createElementVNode("div",ve,[d[2]||(d[2]=e.createElementVNode("div",{class:"upd-filter__text"},null,-1)),e.createElementVNode("div",Ve,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":d[1]||(d[1]=c=>s.value=c),type:"text",placeholder:"样式ID或关键词",onKeyup:e.withKeys(y,["enter"])},null,544),[[e.vModelText,s.value]])])])]),e.createElementVNode("div",$e,[n.loading?(e.openBlock(),e.createElementBlock("div",Ne," 加载中... ")):(e.openBlock(),e.createElementBlock("div",De,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.materials,c=>(e.openBlock(),e.createElementBlock("div",{key:c.id,class:"upd-material-list__item",onClick:f=>l.$emit("select",c)},[e.createElementVNode("div",{class:"upd-material-list__preview",innerHTML:c.html},null,8,Be),e.createElementVNode("div",Le,[e.createElementVNode("span",Me,e.toDisplayString(c.title),1),e.createElementVNode("span",ze,"ID: "+e.toDisplayString(c.id),1)])],8,xe))),128)),n.loadingMore?(e.openBlock(),e.createElementBlock("div",Te," 加载更多... ")):!n.hasMore&&n.materials.length>0?(e.openBlock(),e.createElementBlock("div",Ie," 没有更多数据了 ")):e.createCommentVNode("",!0)]))])])])]))}}),I=(n,o)=>{const t=n.__vccOpts||n;for(const[i,s]of o)t[i]=s;return t},X=I(He,[["__scopeId","data-v-797b48ca"]]),Ue=["width","height","stroke"],Y=I(e.defineComponent({__name:"IconClose",props:{size:{default:24},strokeColor:{default:"currentColor"}},setup(n){return(o,t)=>(e.openBlock(),e.createElementBlock("svg",{width:n.size,height:n.size,viewBox:"0 0 24 24",fill:"none",stroke:n.strokeColor,"stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"icon"},[...t[0]||(t[0]=[e.createElementVNode("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),e.createElementVNode("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1)])],8,Ue))}}),[["__scopeId","data-v-218750c8"]]),Ae={key:0,class:"upd-section-tools__panel"},Re={class:"upd-section-tools__body"},Fe={class:"upd-section-tools__actions"},Pe={class:"upd-section-tools__line"},je={class:"upd-section-tools__field"},qe={class:"upd-section-tools__line"},Ke={class:"upd-section-tools__field"},Oe={class:"upd-section-tools__panel"},We={class:"upd-section-tools__head"},Je={class:"upd-section-tools__desc"},Ze={class:"upd-section-tools__body"},Ge={class:"upd-section-tools__actions"},Qe={class:"upd-section-tools__line"},Xe={class:"upd-section-tools__field"},Ye={class:"upd-section-tools__line"},et={class:"upd-section-tools__field"},tt={class:"upd-section-tools__line"},ot={class:"upd-section-tools__field"},ee=I(e.defineComponent({__name:"SectionTools",props:{sectionData:{},imageData:{},position:{}},emits:["action","image-action","close"],setup(n){return(o,t)=>(e.openBlock(),e.createElementBlock("div",{class:"upd-section-tools",style:e.normalizeStyle({left:n.position.left+"px",top:n.position.top+"px"})},[e.createElementVNode("div",{class:"upd-section-tools__close",onClick:t[0]||(t[0]=i=>o.$emit("close"))},[e.createVNode(Y,{size:16,"stroke-color":"#fff"})]),n.imageData.show?(e.openBlock(),e.createElementBlock("div",Ae,[t[21]||(t[21]=e.createElementVNode("div",{class:"upd-section-tools__head"},[e.createElementVNode("span",{class:"upd-section-tools__title"},"图片")],-1)),e.createElementVNode("div",Re,[e.createElementVNode("div",Fe,[e.createElementVNode("div",{class:"upd-section-tools__action-btn",onClick:t[1]||(t[1]=i=>o.$emit("image-action","change"))}," 换图 ")]),e.createElementVNode("div",Pe,[t[19]||(t[19]=e.createElementVNode("div",{class:"upd-section-tools__label"},"宽度%",-1)),e.createElementVNode("div",je,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[2]||(t[2]=i=>n.imageData.width=i),type:"range",min:"0",max:"100",class:"upd-slider"},null,512),[[e.vModelText,n.imageData.width,void 0,{number:!0}]]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[3]||(t[3]=i=>n.imageData.width=i),type:"number",min:"0",max:"100",class:"upd-input-number"},null,512),[[e.vModelText,n.imageData.width,void 0,{number:!0}]])])]),e.createElementVNode("div",qe,[t[20]||(t[20]=e.createElementVNode("div",{class:"upd-section-tools__label"},"透明度",-1)),e.createElementVNode("div",Ke,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[4]||(t[4]=i=>n.imageData.opacity=i),type:"range",min:"0",max:"1",step:"0.01",class:"upd-slider"},null,512),[[e.vModelText,n.imageData.opacity,void 0,{number:!0}]]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[5]||(t[5]=i=>n.imageData.opacity=i),type:"number",min:"0",max:"1",step:"0.01",class:"upd-input-number"},null,512),[[e.vModelText,n.imageData.opacity,void 0,{number:!0}]])])])])])):e.createCommentVNode("",!0),e.createElementVNode("div",Oe,[e.createElementVNode("div",We,[t[22]||(t[22]=e.createElementVNode("span",{class:"upd-section-tools__title"},"内容块",-1)),e.createElementVNode("span",Je," 样式ID "+e.toDisplayString(n.sectionData.id||"-"),1)]),e.createElementVNode("div",Ze,[e.createElementVNode("div",Ge,[e.createElementVNode("div",{class:"upd-section-tools__action-btn",onClick:t[6]||(t[6]=i=>o.$emit("action","clearFormat"))}," 清除样式 "),e.createElementVNode("div",{class:"upd-section-tools__action-btn",onClick:t[7]||(t[7]=i=>o.$emit("action","newSectionBefore"))}," 前空行 "),e.createElementVNode("div",{class:"upd-section-tools__action-btn",onClick:t[8]||(t[8]=i=>o.$emit("action","newSectionAfter"))}," 后空行 "),e.createElementVNode("div",{class:"upd-section-tools__action-btn",onClick:t[9]||(t[9]=i=>o.$emit("action","select"))}," 选中 "),e.createElementVNode("div",{class:"upd-section-tools__action-btn",onClick:t[10]||(t[10]=i=>o.$emit("action","delete"))}," 删除 "),e.createElementVNode("div",{class:"upd-section-tools__action-btn",onClick:t[11]||(t[11]=i=>o.$emit("action","moveUp"))}," 上移 "),e.createElementVNode("div",{class:"upd-section-tools__action-btn",onClick:t[12]||(t[12]=i=>o.$emit("action","moveDown"))}," 下移 ")]),e.createElementVNode("div",Qe,[t[23]||(t[23]=e.createElementVNode("div",{class:"upd-section-tools__label"},"宽度%",-1)),e.createElementVNode("div",Xe,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[13]||(t[13]=i=>n.sectionData.width=i),type:"range",min:"0",max:"100",class:"upd-slider"},null,512),[[e.vModelText,n.sectionData.width,void 0,{number:!0}]]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[14]||(t[14]=i=>n.sectionData.width=i),type:"number",min:"0",max:"100",class:"upd-input-number"},null,512),[[e.vModelText,n.sectionData.width,void 0,{number:!0}]])])]),e.createElementVNode("div",Ye,[t[24]||(t[24]=e.createElementVNode("div",{class:"upd-section-tools__label"},"旋转角度",-1)),e.createElementVNode("div",et,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[15]||(t[15]=i=>n.sectionData.rotate=i),type:"range",min:"-180",max:"180",class:"upd-slider"},null,512),[[e.vModelText,n.sectionData.rotate,void 0,{number:!0}]]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[16]||(t[16]=i=>n.sectionData.rotate=i),type:"number",min:"-180",max:"180",class:"upd-input-number"},null,512),[[e.vModelText,n.sectionData.rotate,void 0,{number:!0}]])])]),e.createElementVNode("div",tt,[t[25]||(t[25]=e.createElementVNode("div",{class:"upd-section-tools__label"},"透明度",-1)),e.createElementVNode("div",ot,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[17]||(t[17]=i=>n.sectionData.opacity=i),type:"range",min:"0",max:"1",step:"0.01",class:"upd-slider"},null,512),[[e.vModelText,n.sectionData.opacity,void 0,{number:!0}]]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[18]||(t[18]=i=>n.sectionData.opacity=i),type:"number",min:"0",max:"1",step:"0.01",class:"upd-input-number"},null,512),[[e.vModelText,n.sectionData.opacity,void 0,{number:!0}]])])])])])],4))}}),[["__scopeId","data-v-f465a212"]]),nt=["width","height","stroke"],te=I(e.defineComponent({__name:"IconCheck",props:{size:{default:24},strokeColor:{default:"currentColor"}},setup(n){return(o,t)=>(e.openBlock(),e.createElementBlock("svg",{width:n.size,height:n.size,viewBox:"0 0 24 24",fill:"none",stroke:n.strokeColor,"stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"icon"},[...t[0]||(t[0]=[e.createElementVNode("polyline",{points:"20 6 9 17 4 12"},null,-1)])],8,nt))}}),[["__scopeId","data-v-0ae058a4"]]),it={class:"ueditor-plus-designer"},st={class:"ueditor-plus-designer__body"},lt={key:0,class:"ueditor-plus-designer__material"},rt={class:"ueditor-plus-designer__editor"},at={class:"upd-editor-instance"},ct=["id"],dt={key:0,class:"upd-toolbar"},oe=e.defineComponent({__name:"Designer",props:{config:{default:()=>({})},isIframe:{type:Boolean,default:!1}},emits:["ready","change","confirm"],setup(n,{expose:o,emit:t}){const i=n,s=t,a=e.ref(null),y=e.ref(`upd_${Date.now()}`),r=e.ref(!0),l=e.ref(!1),d=e.ref({left:0,top:0}),{categories:c,materials:f,total:N,loading:L,loadingMore:M,currentCategory:D,hasMore:F,changeCategory:P,search:j,loadMore:b}=G(i.config),{currentSection:p,sectionData:H,imageData:_,prepareSectionStyle:q,prepareImageStyle:mt,clearSelection:ut}=Q(),{clearSectionFormat:ft,insertSection:ne,selectSection:ht,deleteSection:pt,moveSectionUp:gt,moveSectionDown:yt}=pe();e.onMounted(async()=>{const m=document.getElementById(y.value);if(m){a.value=new he({...i.config,container:m});try{await a.value.init(),a.value.on("ready",()=>{s("ready"),K()}),a.value.on("change",u=>{s("change",u)}),a.value.on("section-click",St),window.addEventListener("resize",K)}catch(u){console.error("Failed to initialize designer:",u)}}}),e.onUnmounted(()=>{var m;window.removeEventListener("resize",K),(m=a.value)==null||m.destroy()});const wt=m=>{a.value&&a.value.insertSection(m.html,{id:m.id})},Et=m=>{j(m)},St=({section:m,element:u,image:v})=>{p.value=m,q(m),v?mt(m,v):_.value.show=!1,l.value=!0,ie(m)},ie=m=>{if(!a.value)return;const u=a.value.getEditor();if(!u)return;const v=document.querySelector(`#${y.value}`);if(!v)return;const z=v.querySelector(".edui-editor-iframeholder > iframe");if(!z)return;const U=u.document,w=Ct(m,z,U),S=320,E=350,vt=z.getBoundingClientRect(),O=document.querySelector(".ueditor-plus-designer"),se=O==null?void 0:O.getBoundingClientRect();if(!se)return;let W=vt.left-se.left-S;W=Math.max(0,W);let x;if(w.spaceTop>w.spaceBottom&&w.spaceTop>E)x=w.top-E-w.relativeTop,x=Math.max(0,x);else{x=w.top+w.height-w.relativeTop;const Vt=w.top+w.height+w.spaceBottom-w.relativeTop-E;x=Math.min(x,Vt)}d.value={left:W,top:x}},Ct=(m,u,v)=>{const z=document.querySelector(".ueditor-plus-designer");if(!z)return{left:0,top:0,width:0,height:0,containerWidth:0,containerHeight:0,spaceTop:0,spaceBottom:0,spaceLeft:0,spaceRight:0,relativeLeft:0,relativeTop:0};const U=u.getBoundingClientRect(),w=m.getBoundingClientRect(),S=z.getBoundingClientRect(),E={left:U.left+w.left-v.documentElement.scrollLeft,top:U.top+w.top-v.documentElement.scrollTop,width:w.width,height:w.height,containerWidth:S.width,containerHeight:S.height,spaceTop:0,spaceBottom:0,spaceLeft:0,spaceRight:0,relativeLeft:S.left,relativeTop:S.top};return E.spaceTop=E.top-S.top,E.spaceLeft=E.left-S.left,E.spaceBottom=S.top+S.height-(E.top+E.height),E.spaceRight=S.left+S.width-(E.left+E.width),E},K=()=>{l.value&&p.value&&ie(p.value)},k=()=>{p.value&&p.value.classList.remove(g.SectionActiveClass),l.value=!1,ut()},bt=m=>{if(!a.value||!p.value)return;const u=a.value.getEditor();if(u)switch(m){case"clearFormat":ft(u,p.value),k();break;case"newSectionBefore":ne(u,p.value,"before"),k();break;case"newSectionAfter":ne(u,p.value,"after"),k();break;case"select":ht(u,p.value),k();break;case"delete":pt(u,p.value),k();break;case"moveUp":gt(u,p.value),k();break;case"moveDown":yt(u,p.value),k();break}},_t=m=>{console.log("Image action:",m)},kt=()=>{if(a.value){const m=a.value.getContent();s("confirm",m)}};return o({getContent:()=>{var m;return((m=a.value)==null?void 0:m.getContent())||""},setContent:m=>{var u;(u=a.value)==null||u.setContent(m)}}),(m,u)=>(e.openBlock(),e.createElementBlock("div",it,[e.createElementVNode("div",st,[r.value?(e.openBlock(),e.createElementBlock("div",lt,[e.createVNode(X,{categories:e.unref(c),materials:e.unref(f),total:e.unref(N),"current-category":e.unref(D),loading:e.unref(L),"loading-more":e.unref(M),"has-more":e.unref(F),onSelect:wt,onChangeCategory:e.unref(P),onSearch:Et,onLoadMore:e.unref(b)},null,8,["categories","materials","total","current-category","loading","loading-more","has-more","onChangeCategory","onLoadMore"])])):e.createCommentVNode("",!0),e.createElementVNode("div",rt,[e.createElementVNode("div",at,[e.createElementVNode("div",{id:y.value,style:{height:"100%"}},null,8,ct)]),n.isIframe?(e.openBlock(),e.createElementBlock("div",dt,[e.createElementVNode("a",{class:"upd-toolbar__item",href:"javascript:;",onClick:kt},[e.createVNode(te,{size:16}),u[0]||(u[0]=e.createTextVNode(" 完成 ",-1))])])):e.createCommentVNode("",!0)])]),l.value?(e.openBlock(),e.createBlock(ee,{key:0,"section-data":e.unref(H),"image-data":e.unref(_),position:d.value,onAction:bt,onImageAction:_t,onClose:k},null,8,["section-data","image-data","position"])):e.createCommentVNode("",!0)]))}});h.IconCheck=te,h.IconClose=Y,h.MaterialPanel=X,h.SectionTools=ee,h.UEditorPlusDesigner=oe,h.default=oe,h.useMaterial=G,h.useSection=Q,Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
